<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit 66</title>

        <!-- Compiled and minified CSS -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">


                <style>
                   
                </style>
            
</head>
<body>
    <div class="container">
        <div class="col s6">
            <h1>Habit 66</h1>
            <h2>Add or stop a habit for 66 days</h2>
            
        </div>

        <div class="row">
            <form id="myForm" class="col s12">
              
              
              <div class="row">
                <div class="input-field col s10">
                  <input id="habit" type="text" class="validate">
                  <label for="habit">Habit</label>
                </div>
                <button class="btn col s2" type="submit" name="Add">Add</button>
            </form>
              </div>

              <div class="row">
                  <div class="col s12">
                    <ul id="habitslist" class="collection with-header">
                        <li class="collection-header"><h4>Habits</h4></li>

                      </ul>
                  </div>
              </div>
              
              
            
          </div>

    </div>


            <!-- Compiled and minified JavaScript -->
            <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
            


            <script>
                  document.addEventListener('DOMContentLoaded', function() {
                    var elems = document.querySelectorAll('select');
                    var instances = M.FormSelect.init(elems);
                    });

                    // load the habits from previous times

                    for (var key in localStorage){
                        if(key.includes("hb66")){
                            var ul = document.getElementById("habitslist");
                            var li = document.createElement("li");
                            var habit = key.substring(17, key.length);
                            console.log(habit);
                            var endDate = localStorage[key];
                            var daysLeft = (endDate - Date.now()) / ( 24 * 3600 * 1000); 
                            li.innerHTML = habit + " <span>" + Math.round(daysLeft).toString() + " days</span>";
                            li.setAttribute('class', 'collection-item');
                            ul.appendChild(li);
                        }
                    }

                    document.getElementById('myForm').addEventListener('submit', (event) => {
                        event.preventDefault();
                        var habit = document.getElementById("habit").value;
                      
                        
                        var ul = document.getElementById("habitslist");
                        var li = document.createElement("li");
                        var startDate = Date.now();
                        var endDate = startDate + 66 * (24*3600*1000);
                        var daysLeft = (endDate - startDate) / (24*3600*1000);
                        li.innerHTML = habit + " <span>" + daysLeft.toString() + " days</span> <button>Delete</button>";
                        li.setAttribute('class', 'collection-item');
                        ul.appendChild(li);

                        // store the habit for next time
                        window.localStorage.setItem("hb66" + startDate + habit, endDate);
                    });

            </script>

           

            
</body>
</html>